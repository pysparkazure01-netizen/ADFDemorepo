CREATE TABLE IF NOT EXISTS DEV_FRAUD_WAREHOUSE.HUMMINGBIRD_ALERTS_ENT.ALERTS_SNAPSHOT AS
SELECT
    HB_ALERTS_ID,
    ID,
    TRIGGERED_AT,
    RULE,
    REFERENCES,
    OTHER_INFO,
    SOURCESYSTEMID,
    SRC_UNIQ_CD,
    ROW_CRE_DT,
    ROW_MOD_DT,
    EXCLUSION_FLAG,
    CURRENT_DATE AS SNAP_CRE_DT
FROM DEV_FRAUD_WAREHOUSE.HUMMINGBIRD_ALERTS_ENT.ALERTS
WHERE 1 = 0; -- create empty structure


-----
INSERT INTO DEV_FRAUD_WAREHOUSE.HUMMINGBIRD_ALERTS_ENT.ALERTS_SNAPSHOT
SELECT
    HB_ALERTS_ID,
    ID,
    TRIGGERED_AT,
    RULE,
    REFERENCES,
    OTHER_INFO,
    SOURCESYSTEMID,
    SRC_UNIQ_CD,
    ROW_CRE_DT,
    ROW_MOD_DT,
    EXCLUSION_FLAG,
    CURRENT_DATE AS SNAP_CRE_DT
FROM DEV_FRAUD_WAREHOUSE.HUMMINGBIRD_ALERTS_ENT.ALERTS;
